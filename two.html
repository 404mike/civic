<!DOCTYPE html>
<html>

<head>
    <title>Cookie</title>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            console.log('gtag 1 called');
            dataLayer.push(arguments);
        }

        //deny all consent until the user has manually consented
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'analytics_storage': 'denied',
            'functionality_storage': 'denied',
            'personalization_storage': 'denied',
            'security_storage': 'denied'
        });
    </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QDTV3CHP8Z"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            console.log('gtag 2 called');
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'G-QDTV3CHP8Z');
    </script>
</head>

<body>
    <script>
        // Creating a function to dynamically load a script
        function loadScript(src, callback) {
            let script = document.createElement('script');
            script.src = src;
            script.onload = () => callback && callback();
            document.head.appendChild(script);
        }

        // Define the gtag() function and initialize the dataLayer
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }

        // Set default consent configurations before loading the analytics scripts
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied'
        });

        // Load the Google Tag Manager script
        loadScript('https://www.googletagmanager.com/gtag/js?id=GTM-WDXFJZ2', function () {
            console.log('Google Tag Manager script loaded.');
        });


        var config = {
            "apiKey": "ef5bd633b3bf6476b99ec8fd387a8cd2bb9d1f42",
            "product": "PRO_MULTISITE",
            "optionalCookies": [{
                "name": "analytics",
                "label": "Analytical Cookies",
                "description": "Analytical cookies help us to improve our website by collecting and reporting information on its usage.",
                "cookies": [],
                "onAccept": function () {
                    console.log("Analytics accepted");
                    if (typeof gtag === 'function') {
                        console.log("on accept 1");
                        gtag('consent', 'update', {
                            'analytics_storage': 'granted'
                        });
                    }
                },
                "onRevoke": function () {
                    console.log("Analytics rejected");
                    if (typeof gtag === 'function') {
                        console.log("on revoke 1");
                        gtag('consent', 'update', {
                            'analytics_storage': 'denied'
                        });
                    }
                }
            }],
            "position": "left",
            "theme": "light"
        };


        // Load the Civic Cookie Control script
        loadScript("https://cc.cdn.civiccomputing.com/9/cookieControl-9.x.min.js", function () {
            CookieControl.load(config);
            setTimeout(function () {
                let accept = document.getElementById("ccc-notify-accept"),
                    recommended = document.getElementById("ccc-recommended-settings");
                if (accept) {
                    accept.focus();
                } else if (recommended) {
                    recommended.focus();
                }
            }, 250);
        });
    </script>

</body>

</html>